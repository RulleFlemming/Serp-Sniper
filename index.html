<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SERP Sniper - SEO Optimeringsspil</title>
  <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      text-align: center;
      padding: 20px;
      overflow-x: hidden;
    }
    /* Basic container styling */
    .game-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 800px;
      margin: auto;
      position: relative;
      overflow: hidden; /* For potential animations/overlays */
    }

    /* Start-screen overlay */
    .start-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #fff;
      z-index: 999;
      animation: fadeIn 1s ease;
    }
    .start-screen h2 {
      margin-bottom: 1rem;
      font-size: 2rem;
    }
    .start-screen button {
      background: #007bff;
      color: #fff;
      border: none;
      padding: 12px 24px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      animation: pulse 1s infinite;
    }
    .start-screen button:hover {
      background: #0056b3;
    }

    /* fadein animation */
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    /* pulse animation for start button */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    /* progress bar container */
    .progress-bar {
      width: 100%;
      height: 24px;
      background: #eee;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 15px;
      position: relative;
    }
    /* progress bar fill */
    .progress-fill {
      background: #007bff;
      height: 100%;
      color: #fff;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      transition: width 0.4s ease;
    }

    h1 {
      margin-top: 0;
      animation: fadeInDown 0.5s ease;
    }
    @keyframes fadeInDown {
      0% { transform: translateY(-20px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }

    /* The grid (4 rows x 3 columns) */
    .options-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: auto auto auto auto; /* headings row + 3 answer rows */
      gap: 10px;
      margin-top: 20px;
      text-align: center;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }

    .grid-heading {
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-weight: bold;
      padding: 10px;
      animation: fadeIn 0.5s ease;
    }

    .option {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ddd;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.95rem;
      margin: 5px;
      transition: transform 0.2s ease;
    }
    .option:hover {
      transform: scale(1.03);
    }

    .correctOption {
      background: #28a745 !important;
      color: #fff !important;
      font-weight: bold;
    }
    .selected {
      background: #007bff !important;
      color: #fff !important;
    }

    /* shake animation for wrong selection or total */
    .shake {
      animation: shake 0.5s;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      20% { transform: translateX(-5px); }
      40% { transform: translateX(5px); }
      60% { transform: translateX(-5px); }
      80% { transform: translateX(5px); }
      100% { transform: translateX(0); }
    }

    #checkRankBtn {
      background: #007bff;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;
      animation: fadeInUp 0.5s ease;
    }
    @keyframes fadeInUp {
      0% { transform: translateY(20px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }

    #checkRankBtn:hover {
      background: #0056b3;
    }
    #result {
      margin-top: 10px;
      min-height: 30px;
    }

    /* overlay for Level Complete */
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      animation: fadeIn 0.5s ease;
    }
    .overlay-content {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      width: 300px;
      animation: popIn 0.5s ease;
    }
    @keyframes popIn {
      0% { transform: scale(0.8); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    .overlay-content h2 {
      margin: 0 0 10px 0;
    }
    .overlay-content button {
      background: #28a745;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;
    }
    .overlay-content button:hover {
      background: #218838;
    }

  </style>
</head>
<body>
  <div class="game-container">

    <!-- START SCREEN overlay -->
    <div class="start-screen" id="startScreen">
      <h2>Velkommen til SERP Sniper!</h2>
      <p>Dette spil hjælper dig med at optimere din side. Klik for at starte!</p>
      <button id="startButton">Start spillet</button>
    </div>

    <!-- progress bar at top -->
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill" style="width: 0%;">Level 1 af 3</div>
    </div>

    <h1>SERP Sniper: Optimer for at nå #1</h1>
    <p id="businessCase"></p>

    <div class="options-grid" id="optionsGrid">
      <div class="grid-heading">Meta Titel</div>
      <div class="grid-heading">Meta Beskrivelse</div>
      <div class="grid-heading">H1 Overskrift</div>
    </div>

    <button id="checkRankBtn">Tjek min placering</button>
    <p id="result"></p>

    <!-- LEVEL COMPLETE OVERLAY -->
    <div class="overlay" id="levelCompleteOverlay">
      <div class="overlay-content">
        <h2>Level Complete!</h2>
        <p id="overlayMsg">Godt klaret!</p>
        <button id="nextLevelBtn">Næste Level</button>
      </div>
    </div>

  </div>

  <script>
    let streak = 0; // opgavestreak

    const businessCases = {
      1: "Du ejer en café i Aarhus og ønsker at tiltrække flere lokale kunder.",
      2: "Du driver en webshop med bæredygtige sko og vil øge din online synlighed.",
      3: "Du har et fitnesscenter i Odense og ønsker at få flere medlemmer."
    };

    const answerOptions = {
      1: {
        title: ["Hyggelig café i Aarhus", "Byens bedste kaffe", "Lav en kop kaffe hjemme"],
        meta:  ["Nyd en kop friskbrygget kaffe i hjertet af Aarhus", "Mød vennerne til en hyggelig brunch", "Kaffe hurtigt og billigt"],
        h1:    ["Velkommen til Café Aarhus", "Prøv vores specialkaffe", "Kaffe til lavpris"]
      },
      2: {
        title: ["Bæredygtige sko til enhver lejlighed", "Komfort og stil i ét", "Billige sko på tilbud"],
        meta:  ["Find moderne og miljøvenlige sko til hele familien", "Vælg kvalitet og komfort med bæredygtige materialer", "Køb sko til halv pris i dag"],
        h1:    ["Vores udvalg af bæredygtige sko", "Stil og komfort for alle", "Spar penge på fodtøj"]
      },
      3: {
        title: ["Bliv medlem af Odenses bedste fitnesscenter", "Træn med professionelle trænere", "Gratis træning for nye medlemmer"],
        meta:  ["Kom i form med vores personlige trænere og moderne faciliteter", "Træn på dine vilkår med fleksible medlemskaber", "Få adgang til fitness for kun 99 kr./mdr."],
        h1:    ["Velkommen til Fitness Odense", "Dit sundhedscenter i hjertet af byen", "Tilmeld dig i dag og kom i gang"]
      }
    };

    // 0-based index for correct answers
    const correctAnswers = {
      1: { title: 0, meta: 0, h1: 0 },
      2: { title: 0, meta: 0, h1: 0 },
      3: { title: 0, meta: 0, h1: 0 }
    };

    let level = 1;
    const maxLevel = 3;

    function initGame(){
      // show start screen
      document.getElementById('startScreen').style.display = 'flex';
    }

    function startGame(){
      document.getElementById('startScreen').style.display = 'none';
      loadLevel();
    }

    function loadLevel() {
      updateProgressBar(level, maxLevel);
      document.getElementById('businessCase').innerText = businessCases[level];

      const grid = document.getElementById('optionsGrid');
      if (!grid) return;

      // remove old rows beyond headings
      while (grid.children.length > 3) {
        grid.removeChild(grid.lastChild);
      }

      // each category has 3 answers => 3 new rows
      for (let i = 0; i < 3; i++) {
        const titleCell = createOptionCell('title', i);
        const metaCell  = createOptionCell('meta', i);
        const h1Cell    = createOptionCell('h1', i);

        grid.appendChild(titleCell);
        grid.appendChild(metaCell);
        grid.appendChild(h1Cell);
      }
    }

    function createOptionCell(category, index){
      const cell = document.createElement('div');
      cell.classList.add('option');

      const text = answerOptions[level][category][index];
      cell.innerText = text;

      if (correctAnswers[level][category] === index){
        cell.classList.add('correctOption');
      }

      cell.dataset.category = category;
      cell.dataset.index = index;

      cell.addEventListener('click', ()=>{
        removeSelected(category);
        cell.classList.add('selected');
      });

      return cell;
    }

    function removeSelected(category){
      const all = document.querySelectorAll(`.option[data-category='${category}']`);
      all.forEach(opt=>opt.classList.remove('selected'));
    }

    function calculateRank(){
      const titleSel = document.querySelector(".option[data-category='title'].selected");
      const metaSel  = document.querySelector(".option[data-category='meta'].selected");
      const h1Sel    = document.querySelector(".option[data-category='h1'].selected");

      if(!titleSel || !metaSel || !h1Sel){
        showMessage('Vælg en mulighed i alle kategorier!', true);
        return;
      }

      const titleIndex = parseInt(titleSel.dataset.index);
      const metaIndex  = parseInt(metaSel.dataset.index);
      const h1Index    = parseInt(h1Sel.dataset.index);

      const isCorrect = (
        titleIndex === correctAnswers[level].title &&
        metaIndex  === correctAnswers[level].meta  &&
        h1Index    === correctAnswers[level].h1
      );

      if(isCorrect){
        streak++;
        // if they get 2-3 in a row => bonus msg
        if(streak >=2){
          showMessage(`Godt klaret! Du har nu en streak på ${streak} korrekte i træk!`, false);
        } else {
          showMessage('Godt klaret! Du valgte de mest optimale svar.', false);
        }
        // show level complete overlay
        setTimeout(()=>{
          triggerConfetti();
          showLevelComplete();
        }, 500);

      } else {
        // forkert => ryst
        streak = 0;
        document.querySelector('.game-container').classList.add('shake');
        setTimeout(()=>{
          document.querySelector('.game-container').classList.remove('shake');
        }, 500);

        showMessage('Ikke helt korrekt – prøv at justere dine valg.', true);
      }
    }

    function showMessage(msg, isError){
      const res = document.getElementById('result');
      res.innerText = msg;
      if(isError){
        res.style.color = 'red';
      } else {
        res.style.color = 'green';
      }
    }

    function showLevelComplete(){
      document.getElementById('levelCompleteOverlay').style.display = 'flex';
    }

    function hideLevelComplete(){
      document.getElementById('levelCompleteOverlay').style.display = 'none';
    }

    function nextLevel(){
      hideLevelComplete();
      if(level < maxLevel){
        level++;
        document.getElementById('result').innerText = '';
        loadLevel();
      } else {
        document.getElementById('result').style.color = 'green';
        document.getElementById('result').innerText = '🎉 Du har gennemført alle levels! 🎉';
      }
    }

    function triggerConfetti(){
      if(typeof confetti === 'function'){
        confetti({
          particleCount: 100,
          spread: 70,
          origin: { y: 0.6 }
        });
      }
    }

    function updateProgressBar(current, total){
      const fraction = Math.round((current / total)*100);
      const fill = document.getElementById('progressFill');
      if(!fill) return;
      fill.style.width = fraction + '%';
      fill.innerText = `Level ${current} af ${total}`;
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      initGame();
      document.getElementById('startButton').addEventListener('click', startGame);
      document.getElementById('checkRankBtn').addEventListener('click', calculateRank);
      document.getElementById('nextLevelBtn').addEventListener('click', nextLevel);
    });
  </script>
</body>
</html>
