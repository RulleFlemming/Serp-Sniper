<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SERP Sniper - SEO Optimeringsspil</title>
  <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      text-align: center;
      padding: 20px;
    }
    .game-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 800px; /* a bit wider to fit the grid */
      margin: auto;
      position: relative;
    }
    .level-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #007bff;
      color: #fff;
      padding: 5px 10px;
      border-radius: 5px;
      font-weight: bold;
    }
    h1 {
      margin-top: 0;
    }
    /* The entire grid (4 rows x 3 columns) */
    .options-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: auto auto auto auto; /* 1 row for headings, 3 for answer options */
      gap: 10px;
      margin-top: 20px;
      text-align: center;
    }

    /* heading cells (row1) */
    .grid-heading {
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-weight: bold;
      padding: 10px;
    }
    /* answer cells (row2-4) */
    .option {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ddd;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.95rem;
      margin: 5px;
    }
    .correctOption {
      background: #28a745 !important;
      color: #fff !important;
      font-weight: bold;
    }
    .selected {
      background: #007bff !important;
      color: #fff !important;
    }

    #checkRankBtn {
      background: #007bff;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;
    }
    #checkRankBtn:hover {
      background: #0056b3;
    }
    #result {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="level-indicator">Level <span id="level">1</span> af 3</div>
    <h1>SERP Sniper: Optimer for at n√• #1</h1>
    <p id="businessCase"></p>

    <!-- The 4x3 grid -->
    <div class="options-grid" id="optionsGrid">
      <!-- row1: headings -->
      <div class="grid-heading">Meta Titel</div>
      <div class="grid-heading">Meta Beskrivelse</div>
      <div class="grid-heading">H1 Overskrift</div>
      <!-- rows 2,3,4: dynamically created by JS -->
    </div>

    <button id="checkRankBtn">Tjek min placering</button>
    <p id="result"></p>
  </div>

  <script>
    const businessCases = {
      1: "Du ejer en caf√© i Aarhus og √∏nsker at tiltr√¶kke flere lokale kunder.",
      2: "Du driver en webshop med b√¶redygtige sko og vil √∏ge din online synlighed.",
      3: "Du har et fitnesscenter i Odense og √∏nsker at f√• flere medlemmer."
    };

    const answerOptions = {
      1: {
        title: ["Hyggelig caf√© i Aarhus", "Byens bedste kaffe", "Lav en kop kaffe hjemme"],
        meta:  ["Nyd en kop friskbrygget kaffe i hjertet af Aarhus", "M√∏d vennerne til en hyggelig brunch", "Kaffe hurtigt og billigt"],
        h1:    ["Velkommen til Caf√© Aarhus", "Pr√∏v vores specialkaffe", "Kaffe til lavpris"]
      },
      2: {
        title: ["B√¶redygtige sko til enhver lejlighed", "Komfort og stil i √©t", "Billige sko p√• tilbud"],
        meta:  ["Find moderne og milj√∏venlige sko til hele familien", "V√¶lg kvalitet og komfort med b√¶redygtige materialer", "K√∏b sko til halv pris i dag"],
        h1:    ["Vores udvalg af b√¶redygtige sko", "Stil og komfort for alle", "Spar penge p√• fodt√∏j"]
      },
      3: {
        title: ["Bliv medlem af Odenses bedste fitnesscenter", "Tr√¶n med professionelle tr√¶nere", "Gratis tr√¶ning for nye medlemmer"],
        meta:  ["Kom i form med vores personlige tr√¶nere og moderne faciliteter", "Tr√¶n p√• dine vilk√•r med fleksible medlemskaber", "F√• adgang til fitness for kun 99 kr./mdr."],
        h1:    ["Velkommen til Fitness Odense", "Dit sundhedscenter i hjertet af byen", "Tilmeld dig i dag og kom i gang"]
      }
    };

    // 0-based index for correct answers
    const correctAnswers = {
      1: { title: 0, meta: 0, h1: 0 },
      2: { title: 0, meta: 0, h1: 0 },
      3: { title: 0, meta: 0, h1: 0 }
    };

    let level = 1;
    const maxLevel = 3;

    // builds 3 new rows, each with 3 columns, below the heading row
    function loadLevel() {
      document.getElementById("level").innerText = level;
      document.getElementById("businessCase").innerText = businessCases[level];

      const grid = document.getElementById("optionsGrid");
      if (!grid) return;

      // remove old rows (beyond the first 3 headings)
      while (grid.children.length > 3) {
        grid.removeChild(grid.lastChild);
      }
      while (grid.children.length > 3) {
        grid.removeChild(grid.lastChild);
      }

      // We want 3 new rows => each row has 3 categories: (title, meta, h1)
      for (let i = 0; i < 3; i++) {
        // create col1 => title's i-th option
        const titleCell = createOptionCell("title", i);
        const metaCell  = createOptionCell("meta", i);
        const h1Cell    = createOptionCell("h1", i);

        // add them in the grid, col after col
        grid.appendChild(titleCell);
        grid.appendChild(metaCell);
        grid.appendChild(h1Cell);
      }
    }

    // creates the .option cell for the given category and index
    function createOptionCell(category, index) {
      const cell = document.createElement("div");
      cell.classList.add("option");

      const text = answerOptions[level][category][index];
      cell.innerText = text;

      // highlight green if correct
      if (correctAnswers[level][category] === index) {
        cell.classList.add("correctOption");
      }

      cell.dataset.category = category;
      cell.dataset.index = index;

      // on click => select
      cell.addEventListener("click", () => {
        removeSelected(category);
        cell.classList.add("selected");
      });

      return cell;
    }

    function removeSelected(category) {
      const all = document.querySelectorAll(`.option[data-category='${category}']`);
      all.forEach(opt => opt.classList.remove("selected"));
    }

    function calculateRank() {
      const titleSel = document.querySelector(".option[data-category='title'].selected");
      const metaSel  = document.querySelector(".option[data-category='meta'].selected");
      const h1Sel    = document.querySelector(".option[data-category='h1'].selected");

      if (!titleSel || !metaSel || !h1Sel) {
        document.getElementById("result").innerText = "V√¶lg en mulighed i alle kategorier!";
        return;
      }

      const titleIndex = parseInt(titleSel.dataset.index);
      const metaIndex  = parseInt(metaSel.dataset.index);
      const h1Index    = parseInt(h1Sel.dataset.index);

      const isCorrect = (
        titleIndex === correctAnswers[level].title &&
        metaIndex  === correctAnswers[level].meta  &&
        h1Index    === correctAnswers[level].h1
      );

      if (isCorrect) {
        document.getElementById("result").innerText = "#1 - Du dominerer s√∏geresultaterne! üéØ";
        triggerConfetti();
        setTimeout(nextLevel, 2000);
      } else {
        document.getElementById("result").innerText = "#10 - Du skal optimere bedre! üîç";
      }
    }

    function nextLevel() {
      if (level < maxLevel) {
        level++;
        document.getElementById("result").innerText = "";
        loadLevel();
      } else {
        document.getElementById("result").innerText = "üéâ Du har gennemf√∏rt alle levels! üéâ";
      }
    }

    function triggerConfetti() {
      if (typeof confetti === "function") {
        confetti({
          particleCount: 100,
          spread: 70,
          origin: { y: 0.6 }
        });
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      loadLevel();
      document.getElementById("checkRankBtn").addEventListener("click", calculateRank);
    });
  </script>
</body>
</html>
